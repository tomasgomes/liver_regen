---
title: "Testing DecontX"
output: html_notebook
---


This is a test notebook for DecontX. I tried it with one sample. It is sort of slow (~1h for 2.5k cells and 15k genes), and the functions don't work like instructed in the vignette. Checking the amount of correction and correlation of corrected counts also doesn't seem to show many differences, so I will not be using this.

```{r}
library(Seurat)
library(celda)
```



```{r}
load("data/processed/healthy_srat.RData")
```



```{r}
xxx = as.matrix(healthy_srat$sc_H2.HEP.Exp1@assays$RNA@counts)
rs = rowSums(xxx)
storage.mode(xxx) <- "integer"
test_hep2 = decontX(xxx[order(rs, decreasing = T)[1:15000],])
```


```{r}
plot(test_hep2$resList$estConp[order(test_hep2$resList$estConp)])
```


```{r}
cor_mat = cor(test_hep2$resList$estNativeCounts, xxx[order(rs, decreasing = T)[1:15000],])
dd = diag(cor_mat)
plot(dd[order(dd, decreasing = F)])
```

